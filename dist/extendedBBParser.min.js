function getBBElementByTag(e){var t=null;return bbElements.forEach(function(a){return a.tags.includes(e)?void(t=a):void 0}),t}function processLine(e){var l=e.match(bbRegex),n={text:"",tagDepthChange:0};return null===l&&(l=[]),l.forEach(function(e){var t={};if(e.startsWith("[/")){if(t=getBBElementByTag(e.substring(2,e.length-1)),null===t)return void(n.error="ERROR: Closing tag is unknown -> "+e);n.text+="</"+t.htmlElement+">"}else if(e.startsWith("[")){var a=e.match(/\[(\w|\d|\-)+/gm)[0].substring(1);if(t=getBBElementByTag(a),void 0===t||null===t)return void(n.error="ERROR: Openning tag is unknown -> "+a+" | "+e);if(void 0===t.parameters||null===t.parameters||0===t.parameters.length)n.text+=void 0!==t.htmlElementDefaultParams&&null!==t.htmlElementDefaultParams?"<"+t.htmlElement+" "+t.htmlElementDefaultParams+">":"<"+t.htmlElement+">";else{var l=JSON.parse(JSON.stringify(t));l.parameters.forEach(function(e){(void 0===e.isRequired||null===t.isRequired)&&(e.isRequired=!1),e.wasUsed=!1});var r=e.substring(a.length+1,e.length-1),s=r.match(bbArgsRegex);if(null===s&&(s=[]),s.forEach(function(t){var a=t.split(/=(.+)/);if(a.length<2)return void(n.error="ERROR: No value found for argument -> "+t+" | "+e);var r=null;return l.parameters.forEach(a[0].length>0?function(e){e.name.includes(a[0])&&(r=e)}:function(e){e.isDefault&&(r=e)}),null===r?void(n.error="ERROR: Unable to find used parameter -> "+t+" ; For tag -> "+e):(r.value=a[1],r.value.length>=3&&(r.value.startsWith('"')&&(r.value=r.value.substring(1)),r.value.endsWith('"')&&(r.value=r.value.substring(0,r.value.length-1))),void(r.wasUsed=!0))}),void 0!==n.error)return;if(n.text+="<"+l.htmlElement,l.parameters.forEach(function(t){t.isTagParameter&&(t.isRequired&&!t.wasUsed&&(n.error="ERROR: Required parameter was not used -> "+t.name[0]+" | "+e),t.wasUsed&&(n.text+=" "+t.tagValueKey+"="+t.tagValueContentPrefix+t.value+t.tagValueContentSuffix))}),n.text+=">",void 0!==n.error)return;if(l.parameters.forEach(function(t){t.isExternalElement&&(t.isRequired&&!t.wasUsed&&(n.error="ERROR: Required arg was not used -> "+t.name[0]+" | "+e),t.wasUsed&&console.error("WTF !!!"))}),void 0!==n.error)return}}else n.text+=e.replace(/[&<>]/g,{"&":"&amp;","<":"&lt;",">":"&gt;"})}),n}function processText(e){var t="",a=!1,l=!0,n=0;return e.split("\n").forEach(function(e){if(!a){var r=processLine(e,l,n);return void 0!==r.error?(t=r.error,void(a=!0)):("boolean"==typeof r.lineReturnStatus&&(l=r.lineReturnStatus),t+=r.text,t+="\n",n+=r.tagDepthChange,0>n?(t="ERROR: Invalid tag depth ! (Less than 0)",void(a=!0)):void 0)}}),t}const bbElements=[{tags:["b","bold"],htmlElement:"span",htmlElementDefaultParams:'class="bb-bold"'},{tags:["i","italic"],htmlElement:"span",htmlElementDefaultParams:'class="bb-italic"'},{tags:["u","underline"],htmlElement:"span",htmlElementDefaultParams:'class="bb-underline"'},{tags:["s","strikethrough"],htmlElement:"span",htmlElementDefaultParams:'class="bb-strikethrough"'},{tags:["size"],htmlElement:"span",parameters:[{name:["value","size"],isRequired:!0,isDefault:!0,isTagParameter:!0,tagValueKey:"style",tagValueContentPrefix:'"font-size:',tagValueContentSuffix:';"',isExternalElement:!1,externalElementTag:null,externalElementValues:null}]},{tags:["color","colour"],htmlElement:"span",parameters:[{name:["value","color","colour"],isRequired:!0,isDefault:!0,isTagParameter:!0,tagValueKey:"style",tagValueContentPrefix:'"color:',tagValueContentSuffix:';"',isExternalElement:!1,externalElementTag:null,externalElementValues:null}]},{tags:["h1"],htmlElement:"h2"},{tags:["h2"],htmlElement:"h3"},{tags:["h3"],htmlElement:"h4"},{tags:["h4"],htmlElement:"h5"},{tags:["h5"],htmlElement:"h6"},{tags:["sup","supertext"],htmlElement:"sup"},{tags:["sub","subtext"],htmlElement:"sub"},{tags:["footnote"],htmlElement:"span",htmlElementDefaultParams:'class="bb-footnote"'},{tags:["a","link"],htmlElement:"a",parameters:[{name:["url","src"],isRequired:!0,isDefault:!0,isTagParameter:!0,tagValueKey:"href",tagValueContentPrefix:'"',tagValueContentSuffix:'"',isExternalElement:!1,externalElementTag:null,externalElementValues:null}]},{tags:["spoil","spoiler"],htmlElement:"span",htmlElementDefaultParams:'class="bb-spoil"'},{tags:["detail","details"],htmlElement:"details"},{tags:["tab"],htmlElement:"div",htmlElementDefaultParams:'class="bb-tab"'},{tags:["table"],htmlElement:"table"},{tags:["tr","table-row"],htmlElement:"tr"},{tags:["td","table-cell","table-data"],htmlElement:"td",parameters:[{name:["c","colspan"],isRequired:!1,isDefault:!1,isTagParameter:!0,tagValueKey:"colspan",tagValueContentPrefix:"",tagValueContentSuffix:"",isExternalElement:!1,externalElementTag:null,externalElementValues:null},{name:["r","rowspan"],isRequired:!1,isDefault:!1,isTagParameter:!0,tagValueKey:"rowspan",tagValueContentPrefix:"",tagValueContentSuffix:"",isExternalElement:!1,externalElementTag:null,externalElementValues:null}]},{tags:["br"],htmlElement:"br"}],bbRegex=/(\[\/?[a-zA-Z\d\-]+(\s?(\w+)?="?([\w\d:\/\?%\.#]+)"?)*\]|[\w\d\n\t\réèàê\s,\.;\u00C0-\u017F]+)/gm,bbArgsRegex=/([\w\-]*="?([\w\d:\/\?%\.#]+)"?)/gm;